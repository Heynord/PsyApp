global:
  resolve_timeout: 30s

route:
  group_by: ['alertname', 'severity']
  group_wait: 10s
  group_interval: 30s
  repeat_interval: 30s
  receiver: 'telegram-notifications'
  # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
  routes:
    - match:
        severity: critical
      receiver: 'telegram-notifications'
      repeat_interval: 30s  # –ß–∞—â–µ –ø–æ–≤—Ç–æ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã

receivers:
  - name: 'telegram-notifications'
    telegram_configs:
      - bot_token: '7700264301:AAFXSDdWgweDjqT78OjsjARR992bOfHsfKE'
        chat_id: 716522027
        parse_mode: 'HTML'
        message: |
          <b>üö® {{ .Status | toUpper }}: {{ .Alerts.Firing | len }} alert(s)</b>
          {{ range .Alerts }}
          <b>üì¢ –¢–∏–ø:</b> {{ .Labels.alertname }}
          <b>üíª –ó–Ω–∞—á–µ–Ω–∏–µ:</b> {{ .Annotations.description | reReplaceAll ".*current value: ([0-9.]+).*?" "$1" }}
          <b>üïê –ù–∞—á–∞–ª–æ:</b> {{ .StartsAt.Format "2006-01-02 15:04:05" }}
          <b>‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞:</b> {{ .Annotations.summary }}
          <b>‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–º–µ–Ω—å—à–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–∫—É.
          {{ end }}


# –ü—Ä–∞–≤–∏–ª–∞ –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'instance']